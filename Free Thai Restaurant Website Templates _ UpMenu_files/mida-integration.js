void 0===window.executeWithRetry&&(window.executeWithRetry=(t,e,o,r={})=>{const i={maxRetries:5,retryInterval:2e3,enableLogging:!1,...r};let n=0;const a=()=>{if(e())try{o()}catch(e){i.enableLogging&&console.error(t+" execution failed:",e)}else n<i.maxRetries?(n++,i.enableLogging&&console.warn(`${t} not ready, retrying... (${n}/${i.maxRetries})`),setTimeout(a,i.retryInterval)):i.enableLogging&&console.error(`${t} not ready after ${i.maxRetries} retries`)};a()});var previousUrl,integrationObserver,executeWithRetry=window.executeWithRetry,enabledform=(window.executeIntegration=(o={},r="mida_conversion")=>{var i=window.md_int_list[o.id];let n=!1;if(!i)return!1;0===Number(o.variant)&&(o.variant="Control");var a=Object.keys(i);if(a.length)for(let e=0;e<a.length;e++)try{var d=a[e];let t=i[d];if(t){"gtm"!==d||n||(n=!0,window.dataLayer=window.dataLayer||[],o.event=r,window.dataLayer.push(o)),"ga4"===d&&(t.mode&&2===Number(t.mode)&&(!n||n&&"dataLayer"!==t.custom)?("dataLayer"===t.custom&&(n=!0),window[t.custom]=window[t.custom]||[],o.event=r,window[t.custom].push(o)):"function"==typeof gtag?t.debugMode&&1===Number(t.debugMode)?t.format&&2===Number(t.format)?gtag("event",`${r}_${o.id}_`+o.variant.replace(/ /g,"_"),{debug_mode:!0}):(o.debug_mode=!0,gtag("event",r,o)):t.format&&2===Number(t.format)?gtag("event",`${r}_${o.id}_`+o.variant.replace(/ /g,"_")):gtag("event",r,o):window.dataLayer&&(t.debugMode&&1===Number(t.debugMode)?t.format&&2===Number(t.format)?window.dataLayer.push({event:`${r}_${o.id}_`+o.variant.replace(/ /g,"_"),debug_mode:!0}):(o.event=r,o.debug_mode=!0,window.dataLayer.push(o)):t.format&&2===Number(t.format)?window.dataLayer.push({event:`${r}_${o.id}_`+o.variant.replace(/ /g,"_")}):(o.event=r,window.dataLayer.push(o)))),"hubspot"===d&&executeWithRetry(d,()=>"undefined"!=typeof _hsq&&_hsq,()=>{try{_hsq.push(["trackCustomBehavioralEvent",{name:r,properties:o}])}catch(e){console.error("Error calling Hubspot integration:",e)}}),"mixpanel"===d&&executeWithRetry(d,()=>"undefined"!=typeof mixpanel&&mixpanel&&"function"==typeof mixpanel.track,()=>{try{mixpanel.track(r,o)}catch(e){console.error("Error calling Mixpanel integration:",e)}}),"amplitude"===d&&executeWithRetry(d,()=>"undefined"!=typeof amplitude&&amplitude&&"function"==typeof amplitude.track,()=>{try{amplitude.track(r,o)}catch(e){console.error("Error calling Amplitude integration:",e)}}),"klaviyo"===d&&executeWithRetry(d,()=>"undefined"!=typeof klaviyo&&"function"==typeof klaviyo.track||window._learnq,()=>{try{"undefined"!=typeof klaviyo&&"function"==typeof klaviyo.track?klaviyo.track(r,o):window._learnq&&(window._learnq=window._learnq||[],window._learnq.push(["track",r,o]))}catch(e){console.error("Error calling Klaviyo integration:",e)}});let e={event:r,test_id:o.id,test_name:o.name,test_variant:o.variant,timestamp:o.timestamp,uuid:window._h_uuid};if("segment"===d&&executeWithRetry(d,()=>"undefined"!=typeof analytics&&analytics,()=>{try{t.mode&&1===Number(t.mode)?analytics.track(r,o):t.mode&&2===Number(t.mode)?analytics.identify(e):t.mode&&3===Number(t.mode)&&(analytics.track(r,o),analytics.identify(e))}catch(e){console.error("Error calling Segment integration:",e)}}),"http_webhook"===d&&(o.endpoint=t.endpoint,o.method=t.method,o.uuid=window._h_uuid,o.key=window._h_key,o.type="mida_conversion"===r?"conversion":"visit",t.status))try{mida.fetch("/integration/webhook","POST",o,()=>{})}catch(e){console.error(e)}"mc"===d&&executeWithRetry(d,()=>"function"==typeof window.clarity,()=>{try{window.clarity("set",r,`${r}_${o.id}_`+o.variant)}catch(e){console.error("Error calling Microsoft Clarity integration:",e)}}),"hotjar"===d&&executeWithRetry(d,()=>"function"==typeof window.hj||!0,()=>{try{window.hj=window.hj||function(){(hj.q=hj.q||[]).push(arguments)},hj("event",r+"_"+o.id),hj("event",`${r}_${o.id}_`+o.variant)}catch(e){console.error("Error calling Hotjar integration:",e)}},{maxRetries:5}),"cio"===d&&executeWithRetry(d,()=>"undefined"!=typeof _cio&&"function"==typeof _cio.track||window.cio&&"function"==typeof window.cio.track,()=>{try{"undefined"!=typeof _cio&&"function"==typeof _cio.track?_cio.track(r,o):window.cio&&"function"==typeof window.cio.track&&window.cio.track(r,o)}catch(e){console.error("Error calling Customer.io integration:",e)}}),"contentsquare"===d&&executeWithRetry(d,()=>!0,()=>{try{window._uxa=window._uxa||[],window._uxa.push(["trackDynamicVariable",{key:r,value:JSON.stringify({test_id:o.id,test_name:o.name,variant:o.variant,timestamp:o.timestamp})}])}catch(e){console.error("Error calling ContentSquare integration:",e)}},{maxRetries:5})}}catch(e){console.error("Error in window.executeIntegration:",e)}return!0},void 0===window.enabledform&&(window.enabledform={}),window.enabledform),firedPageviewTests=(void 0===window.firedPageviewTests&&(window.firedPageviewTests=new Set),window.firedPageviewTests),referrerDomain=(mida.fetch("/integration/enabled/"+window._h_key,"GET",null,e=>{try{var n,a,d,m=JSON.parse(e);let r=!1,t=!1,o=!1,i=!1;if(m&&m.length){for(let e=0;e<m.length;e++){var c=m[e];c.service.includes("form")&&(enabledform[c.service]=c),"hubspot"===c.service&&(r=!0),"klaviyo"===c.service&&(t=!0),"amplitude"===c.service&&(o=!0),"segment"===c.service&&(i=!0),"ga4"===c.service?(Number(c.mode),c.custom):"gtm"===c.service&&0}("typeform"in enabledform||"tallyform"in enabledform||"jotform"in enabledform||"calendly"in enabledform||"calcom"in enabledform||"fillout"in enabledform||r)&&(n=window.addEventListener?"addEventListener":"attachEvent",(0,window[n])("attachEvent"==n?"onmessage":"message",function(e){var t,o,e=e[e.message?"message":"data"];"typeform"in enabledform&&e.type&&"form-ready"==e.type&&(enabledform.typeform.formId&&e.formId===enabledform.typeform.formId||!enabledform.typeform.formId)&&console.log("[Mida] TypeForm integration ID "+e.formId),"typeform"in enabledform&&e.type&&"form-submit"==e.type&&(enabledform.typeform.formId&&e.formId===enabledform.typeform.formId||!enabledform.typeform.formId)&&(window.mdq?window.mdq.push(["track","typeform-submit",{formId:e.formId}]):mida.track("typeform-submit",{formId:e.formId})),"tallyform"in enabledform&&e.event&&"Tally.FormSubmitted"===e.event&&(enabledform.tallyform.formId&&e.payload.formId===enabledform.tallyform.formId||!enabledform.tallyform.formId)&&(window.mdq?window.mdq.push(["track","tallyform-submit",{formId:e.payload.formId}]):mida.track("tallyform-submit",{formId:e.payload.formId})),"jotform"in enabledform&&e.type&&"submission-completed"===e.action&&(enabledform.jotform.formId&&e.formID===enabledform.jotform.formId||!enabledform.jotform.formId)&&(window.mdq?window.mdq.push(["track","jotform-submit",{formId:e.formID}]):mida.track("jotform-submit",{formId:e.formID})),r&&e.meetingBookSucceeded&&(window.mdq?window.mdq.push(["track","hubspot-meeting-booked",{formId:e.meetingsPayload.formGuid}]):mida.track("hubspot-meeting-booked",{formId:e.meetingsPayload.formGuid})),r&&"hsFormCallback"===e.type&&"onFormSubmitted"===e.eventName&&(window.mdq?window.mdq.push(["track","hubspot-form-submit",{formId:e.id}]):mida.track("hubspot-form-submit",{formId:e.id})),"calendly"in enabledform&&e.event&&0===e.event.indexOf("calendly")&&(t="",o=e.payload||{},"calendly.event_scheduled"===e.event?t="calendly-scheduled":"calendly.date_and_time_selected"===e.event?t="calendly-date-selected":"calendly.event_type_viewed"===e.event&&(t="calendly-viewed"),t)&&(window.mdq?window.mdq.push(["track",t,{eventUri:o.event?o.event.uri:"",inviteeUri:o.invitee?o.invitee.uri:""}]):mida.track(t,{eventUri:o.event?o.event.uri:"",inviteeUri:o.invitee?o.invitee.uri:""})),"fillout"in enabledform&&e.type&&("fillout_form_submitted"===e.type||"fillout.form_submitted"===e.type)&&(window.mdq?window.mdq.push(["track","fillout-submit",{formId:e.formId||(e.payload?e.payload.formId:"")}]):mida.track("fillout-submit",{formId:e.formId||(e.payload?e.payload.formId:"")}))},!1));try{setTimeout(()=>window.mpw(),2e3)}catch(e){console.error("Error in Mida pageview tracking:",e)}if(i&&"undefined"!=typeof analytics&&"function"==typeof analytics.on&&analytics.on("track",function(e,t,o){window.mdq?window.mdq.push(["track",e,t]):mida.track(e,t)}),o&&"undefined"!=typeof amplitude&&"function"==typeof amplitude.logEvent){const s=amplitude.logEvent;amplitude.logEvent=function(e,t){return window.mdq?window.mdq.push(["track",e,t]):mida.track(e,t),s.apply(amplitude,arguments)}}t&&("undefined"!=typeof klaviyo&&"function"==typeof klaviyo.track&&(a=klaviyo.track,klaviyo.track=function(e,t,o){try{window.mdq?window.mdq.push(["track",e,t]):"undefined"!=typeof mida&&"function"==typeof mida.track&&mida.track(e,t)}catch(e){console.warn("Mida tracking error (Klaviyo continues):",e)}return a.apply(klaviyo,arguments)}),window._learnq&&Array.isArray(window._learnq)&&(d=window._learnq.push,window._learnq.push=function(){var e,t,o=Array.prototype.slice.call(arguments);try{0<o.length&&Array.isArray(o[0])&&"track"===o[0][0]&&(e=o[0][1],t=o[0][2]||{},window.mdq?window.mdq.push(["track",e,t]):"undefined"!=typeof mida&&"function"==typeof mida.track&&mida.track(e,t))}catch(e){console.warn("Mida tracking error (_learnq continues):",e)}return d.apply(window._learnq,arguments)}),window.addEventListener("klaviyoForms",function(e){"submit"==e.detail.type&&(window.mdq?window.mdq.push(["track","klaviyo-form-submit",{formId:e.detail.formId}]):mida.track("klaviyo-form-submit",{formId:e.detail.formId}))})),"intercom"in enabledform&&executeWithRetry("intercom",function(){return"function"==typeof window.Intercom},function(){try{window.Intercom("onUserEmailSupplied",function(){window.mdq?window.mdq.push(["track","intercom-email-captured",{}]):mida.track("intercom-email-captured",{})}),window.Intercom("onShow",function(){window.mdq?window.mdq.push(["track","intercom-messenger-opened",{}]):mida.track("intercom-messenger-opened",{})}),window.Intercom("onHide",function(){window.mdq?window.mdq.push(["track","intercom-messenger-closed",{}]):mida.track("intercom-messenger-closed",{})});var t=!1;window.Intercom("onUnreadCountChange",function(e){!t&&1<=parseInt(e)&&(t=!0,window.mdq?window.mdq.push(["track","intercom-message-received",{}]):mida.track("intercom-message-received",{}))})}catch(e){console.warn("Intercom integration error:",e)}},{maxRetries:10,retryInterval:1e3}),"crisp"in enabledform&&executeWithRetry("crisp",function(){return void 0!==window.$crisp&&window.$crisp},function(){try{window.$crisp.push(["on","session:loaded",function(){window.mdq?window.mdq.push(["track","crisp-session-loaded",{}]):mida.track("crisp-session-loaded",{})}]),window.$crisp.push(["on","message:sent",function(){window.mdq?window.mdq.push(["track","crisp-message-sent",{}]):mida.track("crisp-message-sent",{})}]),window.$crisp.push(["on","chat:opened",function(){window.mdq?window.mdq.push(["track","crisp-chat-opened",{}]):mida.track("crisp-chat-opened",{})}])}catch(e){console.warn("Crisp integration error:",e)}},{maxRetries:10,retryInterval:1e3}),"drift"in enabledform&&executeWithRetry("drift",function(){return void 0!==window.drift&&window.drift&&"function"==typeof window.drift.on},function(){try{window.drift.on("emailCapture",function(e){window.mdq?window.mdq.push(["track","drift-email-captured",{email:e.data?e.data.email:""}]):mida.track("drift-email-captured",{email:e.data?e.data.email:""})}),window.drift.on("scheduling:meetingBooked",function(e){window.mdq?window.mdq.push(["track","drift-meeting-booked",{}]):mida.track("drift-meeting-booked",{})}),window.drift.on("conversation:firstInteraction",function(){window.mdq?window.mdq.push(["track","drift-conversation-started",{}]):mida.track("drift-conversation-started",{})})}catch(e){console.warn("Drift integration error:",e)}},{maxRetries:10,retryInterval:1e3}),"calcom"in enabledform&&executeWithRetry("calcom",function(){return"function"==typeof window.Cal},function(){try{Cal("on",{action:"bookingSuccessfulV2",callback:function(e){e=(e.detail||{}).data||{};window.mdq?window.mdq.push(["track","calcom-booked",{eventType:e.eventType||""}]):mida.track("calcom-booked",{eventType:e.eventType||""})}})}catch(e){console.warn("Cal.com integration error:",e)}},{maxRetries:10,retryInterval:1e3})}}catch(e){console.error(e)}}),window.mpw=function(e=!1){try{var t=JSON.parse(localStorage.getItem("_variant_result"))||{};if(e)mida.fetch("/test/exposure","POST",{uuid:window._h_uuid,key:window._h_key},e=>{try{var t=JSON.parse(e);t&&t.length&&t.forEach(e=>{var t={id:Number(e.test_id),name:e.test_name,variant:0===e.variant_id?"Control":e.variant_id,uuid:window._h_uuid,timestamp:+new Date};firedPageviewTests.has(e.test_id)||(window.executeIntegration(t,"mida_pageview")&&firedPageviewTests.add(e.test_id),e.complete&&window.executeIntegration(t,"mida_conversion"))})}catch(e){console.error("Error processing test exposure data:",e)}});else{const r=JSON.parse(localStorage.getItem("_abcache"))||[];r.length&&Object.entries(t).forEach(([t,e])=>{var o=r.find(e=>e&&e.test_id&&e.test_id.toString()===t);o&&(o={id:Number(t),name:o.test_name,variant:"0"===e.vaId.toString()?"Control":e.vaId,uuid:e.uuid,timestamp:+new Date},firedPageviewTests.has(t)||(window.executeIntegration(o,"mida_pageview")&&firedPageviewTests.add(t),e.complete&&window.executeIntegration(o,"mida_conversion")))})}}catch(e){console.error("Error in Mida event tracking:",e)}},document.referrer?new URL(document.referrer).hostname:""),isExternalReferrer=referrerDomain&&referrerDomain!==window.location.hostname,midaRedirectExists=mida.getCookie("mida_redirect"),nextJS=((isExternalReferrer||midaRedirectExists)&&window.mpw(!0),null!==document.querySelector("script[src*='_next/static/']")),gatsby=null!==document.querySelector("#___gatsby"),rootElementExists=null!==document.getElementById("root"),vueExists="function"==typeof window.Vue,generatorMeta=document.querySelector('meta[name="generator"]'),isFramer=generatorMeta&&generatorMeta.content.includes("Framer"),isSPA=window.isSPA||nextJS||gatsby||rootElementExists||vueExists||isFramer;isSPA&&(previousUrl=location.href,(integrationObserver=new MutationObserver(function(){location.href!==previousUrl&&(previousUrl=location.href,firedPageviewTests.clear(),setTimeout(function(){window.mpw()},100))})).observe(document,{subtree:!0,childList:!0}),window.addEventListener("popstate",function(){location.href!==previousUrl&&(previousUrl=location.href,firedPageviewTests.clear(),setTimeout(function(){window.mpw()},100))}));