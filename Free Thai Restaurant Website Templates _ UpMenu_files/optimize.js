!function(j,C,P,m){"use strict";j.mdLoadTiming=performance.now();var b=!1,S=[],M={},A={},R={},r=null,F={},J={},T=!1,l=!1,t="1.2.79",a=(j._executedTests=new Set,j.md_int_list={},j.mdq=j.mdq||[],j.m_goal=[],null!==C.querySelector("script[src*='_next/static/']")),e=null!==C.querySelector("#___gatsby"),i=null!==C.getElementById("root"),n="function"==typeof j.Vue,s=C.querySelector('meta[name="generator"]'),s=s&&s.content.includes("Framer"),I=j.isSPA||a||e||i||n||s,k=!1;function E(){C.body&&(j._midaInitialSnapshot=C.body.cloneNode(!0))}console.log("mida v"+t),j._midaInitialSnapshot=null;var U={log:function(){},success:function(){},error:function(){},warning:function(){},step:function(){},getSummary:function(){},displaySummary:function(){}};function H(){return+new Date}function q(e){try{return null==e?{}:"string"==typeof e?JSON.parse(e):e}catch(e){return{}}}function x(){["optimize_uuid","mida_redirect"].forEach(e=>{C.cookie=e+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT;domain="+j.cookie_domain+";path=/;"});["_abcache","_variant_result","md_ff","md_pending_events","preview-id","preview-variant"].forEach(e=>{try{localStorage.removeItem(e),sessionStorage.removeItem(e)}catch(e){}}),j.vaId=null,j._abcache=null}j.md_cdn||(j.md_cdn=f("cdn")||"https://cdn.mida.so"),j._h_key||(j._h_key=f("key")),j.md_cache===m&&a&&"1Avp2DgnY6yLGdXJbK9koW"!==j._h_key&&!j.location.href.includes("radius.com")&&(j.md_cache=!1),j.md_cache===m&&(j.md_cache=!0);var o=new URLSearchParams(j.location.search),N=o.get("editor")||null;if(o.has("mida-optout"))return console.log("[mida] mida-optout parameter detected - Mida script will not execute"),(e=C.getElementById("abhide"))&&e.parentNode&&e.parentNode.removeChild(e);var h=f("cookie"),d=sessionStorage,u=h?d:localStorage;if(j.mida={isLoaded:!1,backend_url:f("api")||"https://api-us.mida.so",preview:{},uuid:j._h_uuid,user_id:null,hasConsent:"yes"===(localStorage.getItem("mida_consent")||"no"),isRedirect:!1,userID:function(e){this.user_id=e},reload:y,grantConsent:function(e){console.log("Mida grant consent",e),(e?(this.hasConsent=!0,localStorage.setItem("mida_consent","yes"),u.setItem("mida_consent","yes"),j._abcache&&u.setItem("_abcache",j._abcache),j.vaId&&u.setItem("_variant_result",j.vaId),mida.setCookie("optimize_uuid",j._h_uuid),G):(this.hasConsent=!1,localStorage.setItem("mida_consent","no"),u.setItem("mida_consent","no"),x))()},rmfk:function(){var e=C.getElementById("abhide");e&&e.parentNode&&e.parentNode.removeChild(e)},execute:async function(e){var t=mida.preview.id&&r?r:u.getItem("_abcache")||j._abcache;t&&e&&(await j.midaTesting(t,Number(e)),setTimeout(()=>{"function"==typeof j.mpw&&j.mpw(),G()},1e3))},version:function(e){return e?null!==(e=this.getVariant(e))&&0===Number(e)?"Control":e:(e=u.getItem("_variant_result"))?(e=Object.entries(JSON.parse(e)).reduce((e,[t,r])=>(e[t]=r.vaId,e),{}),Object.entries(e).map(([e,t])=>({testId:e,variant:0===t?"Control":t}))):[]},getVariant:function(e){let t=null;var r=j.vaId||u.getItem("_variant_result");return r?(r=(r=q(r))&&r[Number(e)],t=r&&"vaId"in r?r.vaId:t):null},init:function(e){j._h_key=e},identify:function(n){const e=new Promise(async function(t){n.hid=j._h_uuid;var e=await mida.attribution(),r=Object.assign({},n),e=(delete r.hid,Object.assign({},e,r));if(0<Object.keys(e).length)try{var a=j._h_key,i=await mida._enc(e,a);d.setItem("mida_attribution",i)}catch(e){}mida.fetch("/track/"+j._h_key,"POST",n,function(e){e=q(e);j._h_uuid=e.id,j.mida.uuid=e.id,j._hid=e.id,mida.setCookie("optimize_uuid",e.id),t()})});return e.reload=function(){return e.then(function(){return j.mida.reload()})},e},track:function(a,t={}){if(l)return Promise.resolve();let i=H();t.url_origin||(t.url_origin=j.location.origin),t.url_path||(t.url_path=j.location.pathname),t.timestamp||(t.timestamp=i);var e=a+"|"+JSON.stringify(t)+"|"+j._h_session,r=Date.now();if((j._sentEvents||(j._sentEvents=new Map),j._sentEvents.has(e))&&r-j._sentEvents.get(e)<1e3)return Promise.resolve();if(j._sentEvents.set(e,r),50<j._sentEvents.size){var n,s,o=r-1e3;for([n,s]of j._sentEvents)s<o&&j._sentEvents.delete(n)}try{var c=JSON.parse(d.getItem("md_pending_events")||"[]");c.push({event_text:a,event_property:t,session:j._h_session,widget_key:j._h_key,uuid:j._h_uuid,url:j.location.origin+j.location.pathname,href:j.location.href,timestamp:i}),d.setItem("md_pending_events",JSON.stringify(c))}catch(e){console.error("Failed to save event to localStorage:",e)}try{mida._aevt(a,t)}catch(e){console.error("Failed to save event to encrypted cookie:",e)}return new Promise(function(r){var e={event_text:a,event_property:JSON.stringify(t),session:j._h_session,widget_key:j._h_key,uuid:j._h_uuid,url:j.location.origin+j.location.pathname,href:j.location.href};try{"Purchase"===a&&j._revenueGoals&&j._revenueGoals.length&&j._revenueGoals.forEach(e=>{e.goal_id&&(mida.track("goal_"+e.goal_id),mida.converted(e.test_key))})}catch(e){}setTimeout(()=>{var e=F[a];if(e)e.timestamp=i,e.event_name=a,e.variant=null===e.variant?mida.getVariant(e.id):e.variant,j.executeIntegration(e);else if(j.m_goal&&j.m_goal[a]){e=j.m_goal[a];let r=q(u.getItem("_variant_result")||"{}");Array.isArray(e)&&e.forEach(e=>{var t;r[e.id]&&((t={...e}).timestamp=i,t.event_name=a,t.variant=r[e.id].vaId,j.executeIntegration(t))})}},100),mida.fetch("/event/addv3","POST",e,function(e){try{var t=JSON.parse(d.getItem("md_pending_events")||"[]").filter(e=>e.event_text!==a||e.timestamp!==i);d.setItem("md_pending_events",JSON.stringify(t))}catch(e){console.error("Failed to update pending events:",e)}r()})})},converted:function(e){return l?Promise.resolve():new Promise(function(t){mida.fetch("/abtest/convertedv3","POST",{key:e,uuid:j._h_uuid,k:j._h_key},function(e){t()})})},revenue:function(e){return l?Promise.resolve():new Promise(function(t){e.uuid=j._h_uuid,e.k=j._h_key,mida.fetch("/abtest/convertedv3","POST",e,function(e){t()})})},features:[],cachedFeatureFlag:function(){var e=u.getItem("md_ff")||null;return e?(this.features=q(e),this.features):[]},isFeatureEnabled:function(e){return this.features=this.cachedFeatureFlag(),this.features.includes(e)},onFeatureFlags:function(e){let t=this.cachedFeatureFlag().length;this.reloadFeatureFlags().then(()=>{t||e()}).catch(e=>console.error(e)),t&&e()},reloadFeatureFlags:function(){return new Promise((t,r)=>{mida.fetch("/feature-flag","POST",{uuid:j._h_uuid,k:j._h_key,user_id:this.user_id,lang:P.language,url:j.location.href},e=>{try{this.features=JSON.parse(e),u.setItem("md_ff",JSON.stringify(this.features)),t()}catch(e){r(e)}})})},setCookie:function(e,t,r=365,a="d"){var i=new Date,n=j.cookie_domain;if(!n){var s=j.location.hostname;if("localhost"===s||/^\d+\.\d+\.\d+\.\d+$/.test(s))n=s;else{for(var o=s.split("."),c="_domain_test",l=s,d=1;d<o.length;d++){var u="."+o.slice(-d-1).join("."),m=c+"=test;domain="+u+";path=/;";if(C.cookie=c+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT;domain="+u+";path=/;",C.cookie=m,-1!==C.cookie.indexOf(c+"=test")){C.cookie=c+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT;domain="+(l=u)+";path=/;";break}}n=l}j.cookie_domain=n}!h||mida.hasConsent?"h"===a?i.setTime(i.getTime()+60*r*60*1e3):"m"===a?i.setTime(i.getTime()+60*r*1e3):"s"===a?i.setTime(i.getTime()+1e3*r):i.setTime(i.getTime()+24*r*60*60*1e3):i.setTime(i.getTime()+6e4),C.cookie=e+"="+t+";expires="+i.toUTCString()+";domain="+n+";path=/;"},getCookie:function(e){e=C.cookie.match("(^|;)\\s*"+e+"\\s*=\\s*([^;]+)");return e?e.pop():""},attribution:function(){return new Promise(async t=>{var r=d.getItem("mida_attribution")||"";if(r)try{var e=j._h_key;t(await mida._dec(r,e))}catch(e){console.warn("[Mida] Error decrypting user properties, trying as JSON:",e);try{t(JSON.parse(r))}catch(e){console.warn("[Mida] Error parsing user properties from cookie:",e),t({})}}else t({})})},event:function(){return new Promise(async t=>{var r=d.getItem("mida_event")||"";if(r)try{var e=j._h_key,a=await mida._dec(r,e);Array.isArray(a)?t(a):t([])}catch(e){console.warn("[Mida] Error decrypting event properties, trying as JSON:",e);try{var i=JSON.parse(r);Array.isArray(i)?t(i):t([])}catch(e){console.warn("[Mida] Error parsing event properties from cookie:",e),t([])}}else t([])})},_aevt:function(c,l={}){return new Promise(async e=>{if(c.startsWith("goal_")){const s=await mida.event();void e(s)}else{const s=await mida.event();var t={};for(const o in l="string"===l?q(l):l)l.hasOwnProperty(o)&&"timestamp"!==o&&"url_origin"!==o&&"url_path"!==o&&(t[o]=l[o]);var r={n:c},a=(0<Object.keys(t).length&&(r.p=t),s.some(e=>e.n===c)),a=(a||s.push(r),s.slice(-30));if(0<a.length)try{var i=j._h_key,n=await mida._enc(a,i);d.setItem("mida_event",n)}catch(e){console.warn("[Mida] Error encrypting events:",e)}e(a)}})},fetch(e,i,n,s,o=!1){const c=(t=0)=>{const r=new XMLHttpRequest;r.open(i,""+this.backend_url+e,!0),r.setRequestHeader("Content-Type",o?"text/plain":"application/json;charset=UTF-8");let a=!1;r.onreadystatechange=function(){if((this.readyState===r.LOADING||this.readyState===r.DONE)&&200<=this.status&&this.status<300&&!a)try{if(r.responseText&&0<r.responseText.length){var e=r.responseText;if("ok"===e.toLowerCase()||"accepted"===e.toLowerCase())return a=!0,void s(e);if(e.startsWith("{")||e.startsWith("["))try{JSON.parse(e)}catch(e){return}a=!0,s(e)}}catch(e){}this.readyState===r.DONE&&(this.status<200||300<=this.status?t<1&&c(t+1):a||s(r.responseText))},r.send(JSON.stringify(n))};c()},uuid:function(){return new Promise(e=>{const t=()=>{j._h_uuid?e(j._h_uuid):setTimeout(t,100)};t()})},experimentEvent:function(r,a,i={}){return l?Promise.resolve():new Promise(function(t){var e={key:j._h_key,name:r,distinct_id:a||mida.user_id,properties:JSON.stringify(i)};mida.fetch("/experiment/event","POST",e,function(e){t(e)})})},_enc:async function(e,t){var r=crypto.getRandomValues(new Uint8Array(12)),t=await crypto.subtle.importKey("raw",(new TextEncoder).encode(t.padEnd(32,"0")),"AES-GCM",!1,["encrypt"]),t=await crypto.subtle.encrypt({name:"AES-GCM",iv:r},t,(new TextEncoder).encode(JSON.stringify(e))),e=new Uint8Array(r.length+t.byteLength);return e.set(r),e.set(new Uint8Array(t),r.length),btoa(String.fromCharCode(...e))},_dec:async function(e,t){var e=new Uint8Array([...atob(e)].map(e=>e.charCodeAt(0))),r=e.slice(0,12),e=e.slice(12),t=await crypto.subtle.importKey("raw",(new TextEncoder).encode(t.padEnd(32,"0")),"AES-GCM",!1,["decrypt"]),r=await crypto.subtle.decrypt({name:"AES-GCM",iv:r},t,e);return JSON.parse((new TextDecoder).decode(r))}},"no"===localStorage.getItem("mida_consent"))return console.log("Mida script disabled due to declined consent"),x();if(o.has("mida-refresh"))return console.log("[mida] mida-refresh parameter detected - clearing all Mida data"),x(),console.log("[mida] All local Mida data cleared successfully"),(i=mida.getCookie("optimize_uuid")||j._h_uuid)&&j._h_key?mida.fetch("/abtest/clear-visitor","POST",{uuid:i,key:j._h_key},function(e){console.log("[mida] Visitor data deleted from database successfully"),o.delete("mida-refresh");var t=j.location.pathname+(o.toString()?"?"+o.toString():"")+j.location.hash;j.location.href=t}):(o.delete("mida-refresh"),n=j.location.pathname+(o.toString()?"?"+o.toString():"")+j.location.hash,j.location.href=n);j.md_api&&(mida.backend_url=j.md_api);var L,s=o.get("test-preview")||sessionStorage.getItem("preview-id"),e=(s&&(mida.preview.id=s,sessionStorage.setItem("preview-id",s)),o.get("test-variant")||sessionStorage.getItem("preview-variant"));function V(e,t,r){var[a,i]=e.split("?"),[n,s]=t.split("?"),o=a.split("/"),c=n.split("/");let l=-1;var d,u=[];function m(e,t){return t&&(t=t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),t=new RegExp(t.replace("\\*","(.+)")),e=e.match(t))&&e[1]?e[1]:""}if((n=(a=r).indexOf("*"))===a.lastIndexOf("*")&&-1!==n)return a=m(D(e),D(r)),t.replace("*",a).replace(/\?(.+)\?/,"?$1&");for(let e=0;e<c.length;e++)c[e].includes("*")?(l=-1!==o.indexOf(c[e-1])?o.indexOf(c[e-1])+1:o.length-1,d=m(o[l],c[e]),u.push(c[e].replace("*",d)),o.splice(l,1)):u.push(c[e]);c.includes("*")&&-1!==l&&(n=o.slice(l),u.push(...n));let h=u.join("/"),g="";return i&&s&&(g=m(i,s)),s&&(h+="?"+s.replace("*",g)),h}function $(a){return new Promise(t=>{U.log("element","search",a);try{var r=a.replace(/\.+(\s|$|:|>)/g,"$1").replace(/\.\./g,".").replace(/(?:^|\s)\.(?=\s|$)/g,"").trim();r!==a&&U.log("element","clean",r);try{var e=C.querySelector(r);e?U.success("element","found",[r,{tagName:e.tagName,id:e.id,className:e.className,textContent:e.textContent?e.textContent.substr(0,50)+"...":""}]):U.warning("element","notfound",r),t(e)}catch(e){U.error("element","error",[r,e.message]),console.warn("[mida] Error querying element:",e),t(null)}}catch(e){U.error("element","fail",[a,e.message]),t(null)}})}e&&(mida.preview.variant=e,sessionStorage.setItem("preview-variant",e)),s&&(p("/js/mida-preview.js?v="+t),L=setInterval(function(){j.qaLog&&j.qaLog.init&&((U=j.qaLog).init(),clearInterval(L))},50),setTimeout(function(){clearInterval(L)},2e3)),h&&!mida.hasConsent&&(mida.hasConsent="yes"===(u.getItem("mida_consent")||"no")),i="verify",(new j.URL(j.location.href).searchParams.get(i)||"")===j._h_key&&mida.fetch("/widget/active/"+j._h_key,"GET",{},()=>{}),j.midaTesting=async(e,t=null)=>{if(!mida.isRedirect){U.log("test","start",{onlyTestId:t,resultLength:e?e.length:0}),j.applyStart=H();var d,u,m,r=q(e);if(r&&Array.isArray(r)){if(U.log("test","process",r.length),t&&(J[t]=[],j._executedTests.delete(t),["#mcss_"+t,"#mccss_"+t,"#mjs_"+t,"#mcjs_"+t,"#cjs_"+t].forEach(e=>{e=C.querySelector(e);e&&e.parentNode&&e.parentNode.removeChild(e)}),[`mjs_${t}x`,`mcjs_${t}x`,`cjs_${t}x`].forEach(e=>{j[e]&&delete j[e]})),e&&r)for(let e=0;e<r.length;e++){let s=r[e],l=s.test_id;var o,h=s.test_name,g=s.trigger_variant_change;if(U.step(e+1,r.length,`Processing test: ${h} (ID: ${l})`,{testId:l,testName:h,spaRule:g,isPreview:!!mida.preview.id}),j._executedTests.has(l))U.warning("test","exec",l);else if(t&&t!==l)U.log("test","skip",[l,t]);else if(t||"donotstart"!==g){if((!mida.preview.id||Number(l)===Number(mida.preview.id))&&s){let r=null,a=null;if(s.targeting)try{var p=q(s.targeting);r=p.parameter_rule,a=p.schedule_rule}catch(e){console.error("Error parsing targeting:",e)}try{"{}"!==s.integration&&(o=q(s.integration),j.md_int_list[l]=o)}catch(e){}let c=!1;q(s.data);var f=j.location,f=(f.protocol,D(f.hostname),D(f.hostname),new URL(j.location.href)),_=new URLSearchParams(f.search),v=(_.delete("test-preview"),_.delete("test-variant"),f.search=_.toString(),f.toString());let i=!1,n=q(s.data);if(U.log("url","check",[l,{currentUrl:v,testUrls:n?Object.keys(n):[]}]),(i=ie(n,null,v))?U.success("url","match",[l,i]):U.error("url","nomatch",l),!t&&"direct"!==g)if("URLChange"===g){if(M[l]||(M[l]=ce(function(e){let t=ie(n,s.test_url_rule,e);t&&r&&(W(r,e)||(t=!1)),t&&a&&(ne(a,l)||(t=!1)),t?mida.execute(l):(["#mcss_"+l,"#mccss_"+l,"#mjs_"+l,"#mcjs_"+l,"#cjs_"+l].forEach(e=>{e=C.querySelector(e);e&&e.parentNode&&e.parentNode.removeChild(e)}),[`mjs_${l}x`,`mcjs_${l}x`,`cjs_${l}x`].forEach(e=>{j[e]&&delete j[e]}),j._executedTests.delete(l))})),i){let e=!0;(e=r?W(r,v):e)&&mida.execute(l)}}else if("URLChangeAndWaitFor"===g&&!M[l]&&(M[l]=ce(function(e){let t=ie(n,s.test_url_rule,e);t&&r&&(W(r,e)||(t=!1)),t&&(R[l]&&clearInterval(R[l]),R[l]=setInterval(()=>{C.querySelector(s.dom_change_path)&&(mida.execute(l),clearInterval(R[l]))},10))}),i)){let e=!0,t=!0;r&&(e=W(r,v)),a&&(t=ne(a,l)),e&&t&&C.querySelector(s.dom_change_path)&&mida.execute(l)}if(s.test_url_rule&&!X(s.test_url_rule,v)&&(i=!1,U.error("url","rule",l)),i&&r&&(W(r,v)||(i=!1,U.error("url","param",l))),i&&a&&(U.log("schedule","schedcheck",l),ne(a,l)||(i=!1)),i)if(j.abdata=n[i],U.success("url","proceed",[i,{testId:l,matchedPattern:i,testprofile:n[i]}]),t||"direct"===g){var _=!s.is_ab,y=null;let e=null,t=null,r=null,a=mida.getVariant(s.test_id);U.log("variant","get",[l,{priorChosenVersion:a,isPreview:!!mida.preview.variant,previewVariant:mida.preview.variant}]),mida.preview.variant&&(a=mida.preview.variant.replace(/_/," "),U.log("variant","preview",a));var f=!0===s.is_aa,w=(f&&U.log("variant","aa",l),null!==a&&!_||(s.result=q(s.result),z(s,_)),mida.getVariant(s.test_id));if(!mida.preview.variant&&0!==mida.preview.variant||(w=mida.preview.variant.toString().replace(/_/," ")),U.log("variant","final",[l,w,{testId:l,variantName:w,isPersonalization:_,isAATest:f}]),f)F["goal_"+s.goal_id]={id:l,name:h,variant:w},"event"===s.goal_type&&(F[s.goal_value]={id:l,name:h,variant:w}),j._executedTests.add(l);else{if(w&&(_=j.abdata.filter(e=>e.name===w)).length&&(y=(f=_[0]).data,e=f.customCSS||null,t=f.customJS||null),0===Number(w)&&(U.log("variant","control",l),_=s.control_attr&&s.control_attr.js,(f=s.control_attr&&s.control_attr.css)&&(U.log("js","css",l),B(f,"cocss","css")),_)&&Z(_,"cjs",l,"ctrljs","ctrlok","ctrlerr"),F["goal_"+s.goal_id]={id:l,name:h,variant:w},"event"===s.goal_type&&(F[s.goal_value]={id:l,name:h,variant:w}),e&&B(e,"mcss_"+l,"css"),s.custom_css&&B(s.custom_css,"mccss_"+l,"css"),J[l]||(J[l]=[]),y){U.log("dom","domstart",[l,{dataLength:y.length,variant:w}]);for(let o=0;o<y.length;o++){let s=y[o];var b,S,T=s.url;U.log("dom","change",[o+1,y.length,{changeIndex:o,versionUrl:T,hasRedirect:!!T,hasRemove:!!s.rm,hasMove:!!(s.dir&&s.oriEl&&s.refEl),hasInsert:!!(s.dir&&s.refEl&&s.htmlBlock),hasTarget:!!s.target}]);try{var I=new j.URL(T),k=j.location.href,E=V(k,T,i),x=V(k,T,T);if(T.includes("*")&&D(E)!==D(k)&&D(x)!==D(k)||!T.includes("*")&&(D(j.location.hostname)!==D(I.hostname)||j.location.pathname!==I.pathname||I.search&&!j.location.search.includes(I.search)||I.hash&&j.location.hash!==I.hash)){r=T.includes("*")&&T!=k?E:T;var N=C.head.innerHTML.includes("previewBarInjector"),L=null!==C.querySelector("#PBarNextFrameWrapper");let o,c=D(k)!==D(r);if(r&&r.includes("preview_theme_id")?await new Promise(r=>{let a=0;const i=100,n=100,s=()=>{var e=C.head.innerHTML.includes("previewBarInjector"),t=null!==C.querySelector("#PBarNextFrameWrapper");e||t?(o=!1,r()):a>=i?(o=c,r()):(a++,setTimeout(s,n))};s()}):o=!(N||L)&&c,o&&!mida.isRedirect){mida.isRedirect=!0,B("body{opacity:0}","mida-redirect-hide","css"),await G(),await new Promise(e=>setTimeout(e,150)),mida.setCookie("mida_redirect","true",30,"s"),m=void 0,m=P.userAgent||"",/FBAN|FBAV|FBIOS|FB4A|Instagram/i.test(m)&&await new Promise(e=>setTimeout(e,200));let e=s.relay_param?function(e,t){var r,a,[e,t]=[new URL(e),new URL(t)],[i,n]=[e.searchParams,t.searchParams];for([r,a]of i)n.has(r)||n.set(r,a);return e.hash&&(t.hash=e.hash),t.toString()}(k,r):r;e&&e.includes("://.")&&(e=e.replace(/^https?:\/\/\./,"https://")),j.location.href=e}}}catch(e){}try{let n=o+JSON.stringify(s);if(!J[l].includes(n)&&"rm"in s?(U.log("dom","remove",s.rm),await $(s.rm).then(e=>{e?(e.parentNode.removeChild(e),U.success("dom","removed",s.rm),J[l].push(n),c=!0):U.error("dom","rmfail",s.rm)})):!J[l].includes(n)&&s.dir&&s.oriEl&&s.refEl?(U.log("dom","move",[s.oriEl,"a"===s.dir?"after":"before",s.refEl]),b=await $(s.oriEl),S=await $(s.refEl),mida.preview.variant&&b&&b instanceof HTMLElement&&b.classList.add("abhighlight"),b&&S&&"a"===s.dir?(d=b,(u=S)&&d&&u.nextSibling&&u.parentNode.insertBefore(d,u.nextSibling),U.success("dom","moved",["after",s.oriEl,"after",s.refEl]),J[l].push(n),c=!0):b&&S&&"b"===s.dir?(S.parentNode.insertBefore(b,S),U.success("dom","moved",["before",s.oriEl,"before",s.refEl]),J[l].push(n),c=!0):U.error("dom","movefail",{targetFound:!!b,referenceFound:!!S,direction:s.dir})):!J[l].includes(n)&&s.dir&&s.refEl&&"htmlBlock"in s?(U.log("dom","insert",["a"===s.dir?"after":"b"===s.dir?"before":"p"===s.dir?"inside":"",s.refEl]),await $(s.refEl).then(async e=>{var t,r;e?(t="a"===s.dir?"afterend":"b"===s.dir?"beforebegin":"p"===s.dir?"afterbegin":"",r=await le(s.htmlBlock),e.insertAdjacentHTML(t,r),U.success("dom","inserted",[t,s.refEl]),J[l].push(n),c=!0):U.error("dom","insfail",s.refEl)})):s.target&&(U.log("dom","modify",s.target),await $(s.target).then(async t=>{if(t&&t instanceof HTMLElement){U.log("dom","target",{tagName:t.tagName,id:t.id,className:t.className});let e=["textContent","innerText","innerHTML","src","href"],a=["style","class"];for(const i of e)if(i in s){let e=s[i];["textContent","innerText","innerHTML"].includes(i)&&(e=await le(e)),t[i]=e,U.success("dom","prop",[i,e.substr?e.substr(0,50)+"...":e]),"src"===i&&"IMG"===t.tagName&&t.hasAttribute("srcset")&&(t.removeAttribute("srcset"),U.log("dom","srcset"))}var r;a.forEach(e=>{e in s&&(t.setAttribute(e,s[e]),U.success("dom","attr",[e,s[e].substr?s[e].substr(0,50)+"...":s[e]]))}),!J[l].includes(n)&&"outerHTML"in s&&(r=await le(s.outerHTML),t.outerHTML=r,U.success("dom","outer",s.target),J[l].push(n),c=!0),mida.preview.variant&&t.classList.add("abhighlight"),o===y.length-1&&setTimeout(async()=>{const t=C.querySelector(s.target);if(t&&t instanceof HTMLElement){for(const r of e)if(r in s){let e=s[r];["textContent","innerText","innerHTML"].includes(r)&&(e=await le(e)),t[r]!==e&&(t[r]=e,"src"===r)&&"IMG"===t.tagName&&t.hasAttribute("srcset")&&t.removeAttribute("srcset")}a.forEach(e=>{e in s&&t.getAttribute(e)!==s[e]&&t.setAttribute(e,s[e])})}},100)}else U.error("dom","notelem",s.target)})),o<y.length-1){var O=y[o+1];let e=null;O.target?e=O.target:O.rm?e=O.rm:O.oriEl?e=O.oriEl:O.refEl&&(e=O.refEl),e&&!C.querySelector(e)&&(U.log("dom","wait",e),await function(t){return new Promise(e=>setTimeout(e,t))}(100))}}catch(e){console.error(e)}}}t&&Z(t,"mjs",l,"varjs","varok","varerr"),s.custom_js&&Z(s.custom_js,"mcjs",l,"campjs","campok","camperr"),c?(j._executedTests.add(l),U.success("test","done",[l,h])):U.log("test","nochange",[l,h])}}else{if(("DOMChange"===g||"specificDOMChange"===g)&&!mida.preview.variant){f=C.documentElement;try{"specificDOMChange"===g&&s.dom_change_path&&(f=C.querySelector(s.dom_change_path));let e=null,t;M[l]||(A[l]=!0,setTimeout(()=>{A[l]=!1},500),M[l]=new MutationObserver(function(){A[l]||(A[l]=!0,clearTimeout(e),e=setTimeout(()=>{mida.execute(l),setTimeout(()=>{A[l]=!1},500)},500))}),t={attributes:!0,childList:!0,characterData:!0},M[l].observe(f||C.documentElement,{attributes:!0,childList:!0,characterData:!0}))}catch(e){console.error(e)}}R[l]&&clearInterval(R[l]),"waitFor"===g&&(R[l]=setInterval(()=>{if(C.querySelector(s.dom_change_path)){let e=!0;(e=r?W(r,v):e)&&(mida.execute(l),clearInterval(R[l]))}},10))}else U.error("url","urlskip",[l,{testId:l,currentUrl:v,availablePatterns:n?Object.keys(n):[]}]),mida.getCookie("mida_redirect")||setTimeout(()=>{"function"==typeof j.showToast&&j.showToast("Preview Err: the current setup targeting URL and the current URL do not match.")},3e3)}}else U.log("test","spa",l)}G(),setTimeout(()=>{mida.isLoaded=!0,U&&U.enabled&&(U.log("system","complete"),U.displaySummary())},100)}else U.error("test","Invalid test data",{result:e})}};let z=async(t,r=!1)=>{t.distribution;let e=[];j.abdata.length&&(e=j.abdata.map(e=>e.name));[a=100]=[Number(t.traffic_allocation)];var a=(()=>{var e=BigInt("0x"+j._h_uuid);let t=Number(e%BigInt(Number.MAX_SAFE_INTEGER));var e=Math.random,r=(Math.random=function(){var e=1e4*Math.sin(t++);return e-Math.floor(e)},Math.floor(100*Math.random()+1));return Math.random=e,r})()<=a;let i;if(a){r?e.length&&(i=e[0]):i=null!==t.variation?t.variation:(e.push("-1"),0===Number(t.last_variant)&&(t.last_variant="-1"),(e=e.filter(e=>e!==t.last_variant))[Math.floor(Math.random()*e.length)]);a=j.abdata.filter(e=>e.name===i),a=a.length?a[0].name:0;try{let e={};var n=u.getItem("_variant_result");(e=n?q(n):e)[t.test_id]||r||(e[t.test_id]={vaId:a,uuid:j._h_uuid,complete:0}),r&&(e[t.test_id]={vaId:a,uuid:j._h_uuid,complete:0,personalize:1}),e[t.test_id]&&t.complete&&(e[t.test_id].complete=t.complete),j.vaId=JSON.stringify(e),mida.preview.id||u.setItem("_variant_result",j.vaId)}catch(e){console.error(e)}}};function O(){new Promise(async(t,e)=>{j.ga_device_id=mida.getCookie("_ga"),j.ga_uuid=j.ga_device_id.split(".").slice(2).join(".");var r,a=mida.getCookie("optimize_uuid")||j._h_uuid;a&&"undefined"!==a?(j._h_uuid=a,t()):(b=!0,a=function(){try{var e=C.createElement("canvas"),r=e.getContext("2d"),a=(e.width=64,e.height=16,r.fillStyle="#123456",r.fillRect(0,0,32,8),r.fillStyle="#abcdef",r.fillRect(32,8,32,8),r.getImageData(0,0,32,8).data);let t=0;for(let e=0;e<a.length;e+=8)t=31*t+a[e]>>>0;return(t>>>0).toString(36).padStart(6,"0").slice(0,6)}catch(e){return(31*(P.userAgent.length+j.screen.width>>>0)>>>0).toString(36).slice(0,6)}}(),a={key:j._h_key,ua:P.userAgent,lang:P.language,platform:P.platform,height:j.screen.height,width:j.screen.width,color:j.screen.colorDepth,tz:Intl.DateTimeFormat().resolvedOptions().timeZone,l:j.location.href,canvas:a},C.referrer&&(a.r=C.referrer),mida.user_id&&(a.user_id=mida.user_id),j.ga_uuid&&(a.gid=j.ga_uuid),(r=o.get("spoof-ip"))&&(a.spoofIP=r),mida.fetch("/init/uuid","POST",a,e=>{e=q(e);e.setting?(mida.setCookie("optimize_uuid",e.uuid),j._h_uuid=e.uuid,j._h_session=e.session,Y(e.setting,e.global),j.m_goal=e.goal):(l=!0,console.log("[Mida] Project is inactive, stopping all tracking")),t()},!0))}).then(()=>{if(b||y(),!0===I&&ce(function(e){for(var t in J={},j._executedTests.clear(),'[id^="mcss_"],[id^="mccss_"],[id^="cocss"],[id="mgcss"],[id^="mjs_"],[id^="mcjs_"],[id^="cjs_"],[id="mgjs"]'.split(",").forEach(e=>{C.querySelectorAll(e).forEach(e=>e.parentNode&&e.parentNode.removeChild(e))}),j)t.endsWith("x")&&(t.startsWith("mjs_")||t.startsWith("mcjs_")||t.startsWith("cjs_"))&&delete j[t];y()}),!j.otag){if(j.mdq&&j.mdq.length)for(let e=0;e<j.mdq.length;e++)K(j.mdq[e]);j.mdq.pushToList=function(){try{for(let e=0;e<arguments.length;e++){var t=arguments[e];Array.prototype.push.call(this,t),K(t)}}catch(e){console.error("Error processing event:",e)}return this.length},j.mdq.push=j.mdq.pushToList;try{var e=JSON.parse(d.getItem("md_pending_events")||"[]");e.length&&(d.setItem("md_pending_events","[]"),e.forEach(e=>{mida.track(e.event_text,e.event_property)}))}catch(e){console.error("Failed to process pending events:",e)}}let r={};o.forEach(function(e,t){(t.startsWith("mida_")||t.startsWith("utm_")||"ref"===t||"referral"===t||"referrer"===t)&&e&&(r[t]=e)}),0<Object.keys(r).length&&mida.identify(r),p("/js/mida-integration.js?v="+t)}).catch(e=>{console.error(e)})}function D(e){return c(e.toString().replace(/\/\/www\./g,"//").replace(/^(www\.)?/,""))}function c(e){return e.toString().replace(/\/+$/,"")}function g(e,t,r){var a=()=>e(t,r);"loading"===C.readyState?C.addEventListener("DOMContentLoaded",a):a()}function p(t){if(!S.includes(t)){let e=C.createElement("script");e.type="text/javascript",e.src=""+j.md_cdn+t,e.async=!0,e.crossorigin="anonymous",C.body?C.body.appendChild(e):C.addEventListener("DOMContentLoaded",()=>{C.body.appendChild(e)}),S.push(t)}}function K(e){var t=e[0],e=Array.prototype.slice.call(e,1);"function"==typeof mida[t]&&mida[t].apply(mida,e)}function f(t){var r=C.getElementsByTagName("script");let a=null;for(let e=0;e<r.length;e++){var i,n=r[e];if(n.src){let e=null;try{e=new j.URL(n.src)}catch(e){}if("cdn"===t&&e&&e.hostname.endsWith(".mida.so"))return e.protocol+"//"+e.hostname;if("api"===t&&e&&e.hostname.endsWith(".mida.so"))return`https://api-${(i=e.hostname.match(/(?:^|-)([a-z]{2})(?:\.|$)/))?i[1]:"us"}.mida.so`;if(e&&e.hostname.endsWith(".mida.so")){if(e.searchParams.has(t))return e.searchParams.get(t);if(n.getAttribute(t))return n.getAttribute(t)}else e&&e.searchParams.has(t)?a=e.searchParams.get(t):n.getAttribute(t)&&(a=n.getAttribute(t))}}return a||!1}function X(t,r){if(t&&r){t=JSON.parse(t);if(t.length){for(var a of t)if(!a.allowed&&n(a.rule,a.url,r))return;let e=!1;for(var i of t)if(i.allowed){if(n(i.rule,i.url,r))return 1;e=!0}return!e;function n(r,a,i){a=a.trim();let e=null;try{e=new RegExp(a)}catch(e){}if("simple"!==r)return"exact"===r?a===i:"regex"===r?e&&e.test(i):"contain"===r&&i.includes(a);{a.trim().startsWith("http")||(a="https://"+a);r=new URL(a),a=new URL(i);let e=r.hostname+r.pathname,t=a.hostname+a.pathname;return e=e.replace(/^www\./,"").replace(/\/$/,""),t=t.replace(/^www\./,"").replace(/\/$/,""),e===t}}}}}function G(){return new Promise(function(e){if(l||h&&!mida.hasConsent)return e();function t(){clearTimeout(r),e()}var r=setTimeout(e,2e3);try{var a=Object.assign({},q(u.getItem("_variant_result")),q(j.vaId)),i=JSON.stringify(a);if(!Object.keys(a).length||j._lastSentPayload===i)return t();u.setItem("_variant_result",i),j._lastSentPayload=i,fetch(`${mida.backend_url||"https://api.mida.so"}/abtest/visitor`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({uuid:j._h_uuid,key:j._h_key,variation:i,bot:T}),keepalive:!0,credentials:"omit"}).then(()=>{t()}).catch(()=>{t()})}catch(e){t()}})}async function Y(t,e=!1){if(mida.preview.id||N||"[]"===t||u.setItem("_abcache",t),j._abcache=t,mida.preview.id&&!r&&(r=t),e&&e.js&&(B(`function mgjs() { ${e.js} }`,"mgjs"),setTimeout(()=>{try{mgjs()}catch(e){}},0)),e&&e.css&&B(e.css,"mgcss","css"),!e)try{let e=JSON.parse(t);e=e.filter(e=>0!==Number(e.cache)),t=JSON.stringify(e)}catch(e){}"[]"===t||mida.isRedirect||(await j.midaTesting(t),a&&!j.md_cache&&(j.md_cache=!0)),setTimeout(()=>{var e=document.getElementById("wpr-usedcss");e&&(e.innerHTML=e.innerHTML.replace(/body\s*\{\s*opacity\s*:\s*0\s*;?\s*\}/,"")),mida.isRedirect||mida.rmfk()},50),setTimeout(()=>{j.mfunc&&Array.isArray(j.mfunc)&&(j.mfunc.forEach(e=>{try{e()}catch(e){}}),j.mfunc=[]),G()},200)}function B(e,t,r="javascript"){var a;C.getElementById(t)||((a=C.createElement("css"===r?"style":"script")).setAttribute("id",t),a.setAttribute("type","text/"+r),t=C.createTextNode(e),a.appendChild(t),(C.body||C.head).appendChild(a))}function Z(e,t,r,a,i,n){U.log("js",a,r);let s=t+"_"+r;B(`function ${s}() { ${e} }`,s),setTimeout(()=>{try{j[s+"x"]||(j[s](),U.success("js",i,s)),j[s+"x"]=!0}catch(e){U.error("js",n,[s,e.message]),"cjs"===t&&console.error("Error executing control JS:",e)}},0)}g(E);var _=null,v=null,Q=!1;var ee=!0;function y(){var e,t;!I&&ee||E(),ee=!1,j.md_cache&&!mida.preview.id&&((e=u.getItem("_abcache"))&&g(Y,e),u.removeItem("_abcache")),mida.isRedirect||(e=mida.preview.id,e={k:j._h_key,url:j.location.href,lang:P.language,uuid:j._h_uuid,gid:j.ga_uuid,preview:e},mida.user_id&&(e.user_id=mida.user_id),C.referrer&&(e.r=C.referrer),(t=d.getItem("mida_event")||"")&&(e.e=t),(t=d.getItem("mida_attribution")||"")&&(e.a=t),(t=o.get("spoof-ip"))&&(e.spoofIP=t),mida.fetch("/test/setting2","POST",e,e=>{e=q(e);e.setting?(j._h_session=e.session,Y(e.setting,e.global),j.m_goal=e.goal):(l=!0,console.log("[Mida] Project is inactive, stopping all tracking"))},!0),g(function(){v&&(clearInterval(v),v=null),_&&_.parentNode&&_.parentNode.removeChild(_),(_=C.createElement("div")).id="_mida_sentinel",_.style.cssText="display:none!important;position:absolute!important;",C.body?C.body.appendChild(_):g(function(){C.body&&_&&!_.parentNode&&C.body.appendChild(_)}),v=setInterval(function(){_&&!Q&&C.body&&!C.body.contains(_)&&(Q=!0,clearInterval(v),v=null,setTimeout(function(){y(),Q=!1},50))},200)}))}var te=!1;function re(){te||l||(p("/js/mida-event.js?v="+t),p("/js/mida-goal.js?v="+t),setTimeout(()=>{mida.fetch("/widget/event/"+j._h_key,"GET",null,j.processEvent)},250),mida.track("_pageview"),te=!0)}function ae(){g(p,"/js/live-editor.js?v="+t)}if(C.addEventListener("mousemove",re),setTimeout(re,1e3),j.opener||N){!j.opener&&N&&ae();n="addEventListener"in j;if(j[n?"addEventListener":"attachEvent"](n?"message":"onmessage",e=>{var{event_id:e,previewId:t,previewVariant:r}=e.data;"5959"===e?ae():"5960"===e&&Object.assign(mida.preview,{id:t,variant:r})},!1),j.opener)try{j.opener.postMessage({event_id:"5555",data:{status:"load-editor"}},"*")}catch(e){console.error(e)}}if(a&&"1Avp2DgnY6yLGdXJbK9koW"!==j._h_key&&!j.location.href.includes("radius.com")){let e,t=new MutationObserver(()=>{clearTimeout(e),e=setTimeout(()=>{t.disconnect(),k=!0,O()},200)});t.observe(C.body,{childList:!0,subtree:!0}),setTimeout(()=>{k||(t.disconnect(),O())},1e3)}else O();function ie(e,t,r){if(!e)return!1;var a=r?new URL(r):j.location,i=a.protocol+"//"+D(a.hostname)+a.pathname,a=a.protocol+"//www."+D(a.hostname)+a.pathname,r=new URL(r||j.location.href),n=new URLSearchParams(r.search),n=(n.delete("test-preview"),n.delete("test-variant"),r.search=n.toString(),r.toString());let s=[i,c(i),a,c(a),c(n),D(n)],o=Object.keys(e).find(t=>{if(s.some(e=>t.toLowerCase()===e.toLowerCase()))return U.success("url-debug",`Pattern "${t}" matched directly!`,{pattern:t,matchingUrls:s.filter(e=>t.toLowerCase()===e.toLowerCase())}),!0;let r=new RegExp("^"+t.replace(/\*/g,".*").replace(/\?/g,"\\?").replace(/\/+$/g,"").replace("//www.","//(www.)?")+"$","i");var e=s.some(e=>r.test(e.toLowerCase()));return e?U.success("url-debug",`Pattern "${t}" matched with regex!`,{pattern:t,regex:r.toString(),matchingUrls:s.filter(e=>r.test(e.toLowerCase()))}):U.warning("url-debug",`Pattern "${t}" did not match any URL variations`,{pattern:t,regex:r.toString(),urlVariations:s.map(e=>e.toLowerCase()),testResults:s.map(e=>({url:e.toLowerCase(),matches:r.test(e.toLowerCase())}))}),e});return o=t&&!X(t,n)?!1:o}function W(e,t){if(!e||!t)return!0;var r=null;try{r="object"==typeof e?e:JSON.parse(e)}catch(e){return!0}for(var a=new URL(t).searchParams,i=!1,n=0;n<r.length;n++){for(var s=r[n],o=!1,c=0;c<s.length;c++){var l=s[c].criteria,d=s[c].operator,u=s[c].value;if(function(e,t,r){var a,i,n=!1,s=e,o=r;if("bt"===t||"bf"===t)"boolean"==typeof s?n="bt"===t?!0===s:!1===s:"number"==typeof s?n="bt"===t?1===s:0===s:"string"==typeof s&&(a="true"===s.toLowerCase()||"1"===s,n="bt"===t?a:!a);else{if(-1<[">",">=","<","<=","gt","gte","lt","lte"].indexOf(t))return a=String(s).replace(/,/g,""),i=String(o).replace(/,/g,""),a=parseFloat(a),i=parseFloat(i),isNaN(a)||isNaN(i)||(">"!==t&&"gt"!==t||(n=i<a),">="!==t&&"gte"!==t||(n=i<=a),"<"!==t&&"lt"!==t||(n=a<i),"<="!==t&&"lte"!==t)?n:a<=i;if(-1<["days_gt","days_lt","days_gte","days_lte"].indexOf(t))try{var c=new Date(s),l=new Date,d=Math.floor((l-c)/864e5),u=parseFloat(String(o).replace(/,/g,""));isNaN(c.getTime())||isNaN(u)||("days_gt"===t&&(n=u<d),"days_gte"===t&&(n=u<=d),"days_lt"===t&&(n=d<u),"days_lte"===t&&(n=d<=u))}catch(e){}else{null!==e&&e!==m||(e=""),null!==r&&r!==m||(r="");try{e=e.toString(),r=r.toString()}catch(e){}"=="===t&&(n=e===r),"!="===t&&(n=e!==r),"**"===t&&"string"==typeof e&&"string"==typeof r&&(n=-1<e.toLowerCase().indexOf(r.toLowerCase())),"!*"===t&&"string"==typeof e&&"string"==typeof r&&(n=-1===e.toLowerCase().indexOf(r.toLowerCase())),"ex"===t&&(n=Boolean(e)),"nx"===t&&(n=!e)}}return n}(a.get(l),d,u)){o=i=!0;break}}if(!1===o){i=!1;break}}return i}function ne(e,t){if(!e)return!0;if(null!==mida.getVariant(t))return U.success("schedule","schedskip",t),!0;let r=null;try{r="object"==typeof e?e:JSON.parse(e)}catch(e){return!0}if(!r||!r.scheduleGroups||0===r.scheduleGroups.length)return!0;var e=new Date,a=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"][e.getDay()],i=60*e.getHours()+e.getMinutes(),n=String(Math.floor(i/60)).padStart(2,"0")+":"+String(i%60).padStart(2,"0");U.log("schedule","schedinfo",[t,r.scheduleGroups.length]);for(var s=0;s<r.scheduleGroups.length;s++){var o=r.scheduleGroups[s],c=o.days?o.days.join(", "):"none",l=o.timeRanges?o.timeRanges.map(function(e){return e.start+"-"+e.end}).join(", "):"none";if(U.log("schedule","schedgroup",[s+1,c,l]),o.days&&-1!==o.days.indexOf(a))for(var d=0;d<o.timeRanges.length;d++){var u=o.timeRanges[d],m=u.start.split(":"),u=u.end.split(":"),m=60*parseInt(m[0],10)+parseInt(m[1],10),u=60*parseInt(u[0],10)+parseInt(u[1],10);if(u<m?m<=i||i<=u:m<=i&&i<=u)return U.success("schedule","schedmatch",[t,a,n,"Group "+(s+1)+": "+c+" at "+l]),!0}}return U.error("schedule","schednomatch",[t,a,n]),!1}var w=[],se=!1,oe=location.href;function ce(t){function e(){if(location.href!==oe){var e=location.href;oe=e;for(var t=0;t<w.length;t++)try{w[t](e)}catch(e){console.error("[mida] URL change callback error:",e)}}}var r,a;return se||(se=!0,new MutationObserver(e).observe(C,{subtree:!0,childList:!0}),j.addEventListener("popstate",e),r=history.pushState,a=history.replaceState,history.pushState=function(){r.apply(this,arguments),e()},history.replaceState=function(){a.apply(this,arguments),e()}),w.push(t),function(){var e=w.indexOf(t);-1<e&&w.splice(e,1)}}async function le(t){if(!t||"string"!=typeof t)return t;try{const a=await mida.attribution();var e=t.replace(/{{([ ]*[a-z0-9_-]+[ ]*\|?[ ]*[^}]*)}}/gi,(e,t)=>{var[t,,]=t.trim().split("|").map(e=>e.trim());let r="";return(r=a&&a.hasOwnProperty(t)?(a[t]||"").toString():r).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;").replace(/\'/g,"&#39;").replace(/\//g,"&#x2F;")});return t!==e&&j._h_debug&&console.log("[Mida Debug] parseKeywordFromAttribution:",{original:t,result:e,attributionData:a}),e}catch(e){return console.warn("[Mida] Error parsing keywords from attribution:",e),t.replace(/{{([ ]*[a-z0-9_-]+[ ]*\|?[ ]*[^}]*)}}/gi,"")}}}(window,document,navigator);